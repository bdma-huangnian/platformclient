(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"C6+7":function(t,n,e){"use strict";e.r(n);var l=e("LY6o");class o{}var i=e("pMnS"),r=e("MKJQ"),a=e("2jpv"),s=e("ysn3"),c=e("3JjO"),u=e("D2kv"),p=e("LoWC");class h{constructor(t,n,e){this.app=t,this.http=n,this.alertController=e,this.company={company_id:this.app.companyId,tinyapp_id:this.app.tinyappId}}getCategory(){return new Promise((t,n)=>{this.http.get("https://www.dinghuo365.vip/index.php/MallAPI/Namecard/getPosterCategory",{params:this.getHttpParams()}).pipe(Object(p.a)(1)).toPromise().then(e=>{1===e.status?t(e.data):(this.alert(e.info),n(e.info))})})}getPosters(t,n=1){return new Promise((e,l)=>{this.http.get("https://www.dinghuo365.vip/index.php/MallAPI/Namecard/getDailyPoster",{params:this.getHttpParams({cate_name:t,p:n})}).pipe(Object(p.a)(1)).toPromise().then(t=>{1===t.status?e(t.data):(this.alert(t.info),l(t.info))})})}generaterPoster(t){return new Promise((n,e)=>{this.http.get("https://www.dinghuo365.vip/index.php/MallAPI/Namecard/getPosterPhotoShow",{params:this.getHttpParams(t)}).pipe(Object(p.a)(1)).toPromise().then(t=>{1===t.status?n(t.data):(this.alert(t.info),e(t.info))})})}getHttpParams(t={}){return new c.g({fromObject:Object.assign({},t,this.company)})}alert(t){return new Promise(n=>{this.alertController.create({header:t,buttons:[{text:"\u786e\u8ba4",role:"cancel"}]}).then(t=>{t.present(),t.onDidDismiss().then(()=>{n()})})})}}var d=e("/WN3"),b=e("WceA"),g=e("CX4n"),m=e("b1hG");class f{constructor(t,n,e,l,o){this.posterService=t,this.loadingController=n,this.topComponentService=e,this.toastController=l,this.authenticationService=o,this.category={active:0,data:[]},this.posters=new Map,this.data=[],this.currentPage=1,this.scrollToTopFlag=!1}ngOnInit(){}ionViewDidEnter(){return d.__awaiter(this,void 0,void 0,(function*(){const t=yield this.loadingController.create();t.present();const n=yield this.posterService.getCategory().catch(t=>{console.log(t)}).finally(()=>{t.dismiss()});this.category.data=n,t.present(),this.posterService.getPosters(this.category.data[0].title).then(t=>{this.posters.set(0,t||[]),this.data=t||[],this.ionInfiniteScroll.disabled=t.length<10}).catch(()=>{}).finally(()=>{t.dismiss()})}))}changeCategory(t){return d.__awaiter(this,void 0,void 0,(function*(){if(this.category.active=t,this.posters.get(t))return void(this.data=this.posters.get(t));const n=yield this.loadingController.create();n.present(),this.posterService.getPosters(this.category.data[t].title).then(n=>{this.data=n||[],this.posters.set(t,n||[]),this.ionInfiniteScroll.disabled=n.length<10,this.ionContent.scrollToTop(0)}).catch(()=>{}).finally(()=>{n.dismiss()})}))}generaterPoster(t,n){return d.__awaiter(this,void 0,void 0,(function*(){const e=this.hideInput.nativeElement;e.value=n,e.select(),document.execCommand("Copy");const l=yield this.toastController.create({message:"\u6587\u5b57\u590d\u5236\u6210\u529f\uff0c\u6b63\u5728\u751f\u6210\u5206\u4eab\u56fe...",duration:1500,color:"dark",position:"middle",cssClass:"toast-middle"});l.present(),yield l.onWillDismiss();const o=yield this.loadingController.create();o.present();const i=yield this.posterService.generaterPoster({id:t,page_name:"page/index/index",auth_type:1,token:this.authenticationService.token||""}).catch(()=>{}).finally(()=>{o.dismiss()});this.viewPoster(i)}))}loadMore(){return d.__awaiter(this,void 0,void 0,(function*(){this.currentPage+=1,this.posterService.getPosters(this.category.data[this.category.active].title,this.currentPage).then(t=>{this.data=this.data.concat(t),this.posters.set(this.category.active,this.data),this.ionInfiniteScroll.disabled=t.length<10}).catch(t=>{console.log(t)}).finally(()=>this.ionInfiniteScroll.complete())}))}viewPoster(t){this.topComponentService.load(m.a).then(n=>{n.present(t)})}}var x=l.ob({encapsulation:0,styles:[['ion-content[_ngcontent-%COMP%]{--padding-start:110px}ion-content[_ngcontent-%COMP%]   .category-left[_ngcontent-%COMP%]{position:fixed;left:0;bottom:0;width:110px;overflow:auto;background:#f3f5fe;z-index:10}ion-content[_ngcontent-%COMP%]   .category-left[_ngcontent-%COMP%]   .category-left_item[_ngcontent-%COMP%]{display:block;display:flex;font-size:14px;padding:7px 0;height:50px;line-height:25px;align-items:center;justify-content:center;box-sizing:content-box;position:relative;transition:all .3s}ion-content[_ngcontent-%COMP%]   .category-left[_ngcontent-%COMP%]   .category-left_item[_ngcontent-%COMP%]::after{content:"";position:absolute;width:4px;top:15px;bottom:15px;left:-4px;transition:left .3s;background:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]   .category-left[_ngcontent-%COMP%]   .category-left_item.active[_ngcontent-%COMP%]{background:#fff;font-weight:700;color:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]   .category-left[_ngcontent-%COMP%]   .category-left_item.active[_ngcontent-%COMP%]::after{left:0}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]{margin-bottom:15px;border-bottom:1px solid #efefef;padding:0 12px}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]   .poster-item_title[_ngcontent-%COMP%]{margin:0;font-size:16px;color:#545454;line-height:24px;padding:12px 0}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:65%;border-radius:3px;-webkit-user-select:none;-moz-user-select:none;user-select:none}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]   .poster-item_handler[_ngcontent-%COMP%]{line-height:28px;font-size:15px;padding:15px 0}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]   .poster-item_handler[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{float:right;--border-radius:5px;height:28px;margin:0;font-size:14px;--padding-start:8px}ion-content[_ngcontent-%COMP%]   .poster-item[_ngcontent-%COMP%]   .poster-item_handler[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:5px}ion-content[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{transform:translateY(100px);transition:transform .3s}ion-content[_ngcontent-%COMP%]   ion-fab.active[_ngcontent-%COMP%]{transform:translateY(0)}input#hide-input[_ngcontent-%COMP%]{position:fixed;z-index:-1;opacity:0;-webkit-user-select:none;-moz-user-select:none;user-select:none}']],data:{}});function P(t){return l.Lb(0,[(t()(),l.qb(0,0,null,null,5,"ion-text",[["class","category-left_item"],["color","medium"]],null,[[null,"click"]],(function(t,n,e){var l=!0;return"click"===n&&(l=!1!==t.component.changeCategory(t.context.index)&&l),l}),r.Pb,r.S)),l.Gb(512,null,a.r,a.s,[l.q,l.r,l.k,l.B]),l.pb(2,278528,null,0,a.h,[a.r],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),l.Eb(3,{active:0}),l.pb(4,49152,null,0,s.ub,[l.h,l.k,l.x],{color:[0,"color"]},null),(t()(),l.Jb(5,0,[" "," "]))],(function(t,n){var e=t(n,3,0,n.component.category.active===n.context.index);t(n,2,0,"category-left_item",e),t(n,4,0,"medium")}),(function(t,n){t(n,5,0,n.context.$implicit.title)}))}function C(t){return l.Lb(0,[(t()(),l.qb(0,0,null,null,5,"div",[["class","category-left"]],null,null,null,null,null)),l.Gb(512,null,a.t,a.u,[l.k,l.r,l.B]),l.pb(2,278528,null,0,a.m,[a.t],{ngStyle:[0,"ngStyle"]},null),l.Eb(3,{top:0}),(t()(),l.fb(16777216,null,null,1,null,P)),l.pb(5,278528,null,0,a.i,[l.M,l.J,l.q],{ngForOf:[0,"ngForOf"]},null)],(function(t,n){var e=n.component,l=t(n,3,0,e.ionHeader.el.offsetHeight+"px");t(n,2,0,l),t(n,5,0,e.category.data)}),null)}function v(t){return l.Lb(0,[(t()(),l.qb(0,0,null,null,12,"div",[["class","poster-item"]],null,null,null,null,null)),(t()(),l.qb(1,0,null,null,1,"h6",[["class","poster-item_title"]],null,null,null,null,null)),(t()(),l.Jb(2,null,["",""])),(t()(),l.qb(3,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(t()(),l.qb(4,0,null,null,8,"div",[["class","poster-item_handler"]],null,null,null,null,null)),(t()(),l.qb(5,0,null,null,2,"ion-text",[["color","medium"]],null,null,null,r.Pb,r.S)),l.pb(6,49152,null,0,s.ub,[l.h,l.k,l.x],{color:[0,"color"]},null),(t()(),l.Jb(7,0,["",""])),(t()(),l.qb(8,0,null,null,4,"ion-button",[["color","primary"],["mode","ios"],["size","default"]],null,[[null,"click"]],(function(t,n,e){var l=!0;return"click"===n&&(l=!1!==t.component.generaterPoster(t.context.$implicit.id,t.context.$implicit.title)&&l),l}),r.bb,r.e)),l.pb(9,49152,null,0,s.k,[l.h,l.k,l.x],{color:[0,"color"],mode:[1,"mode"],size:[2,"size"]},null),(t()(),l.qb(10,0,null,0,1,"ion-icon",[["name","share-social"],["size","small"]],null,null,null,r.ob,r.r)),l.pb(11,49152,null,0,s.C,[l.h,l.k,l.x],{name:[0,"name"],size:[1,"size"]},null),(t()(),l.Jb(-1,0,[" \u4fdd\u5b58 "]))],(function(t,n){t(n,6,0,"medium"),t(n,9,0,"primary","ios","default"),t(n,11,0,"share-social","small")}),(function(t,n){t(n,2,0,n.context.$implicit.title),t(n,3,0,n.context.$implicit.cover_img),t(n,7,0,n.context.$implicit.create_time)}))}function _(t){return l.Lb(0,[l.Hb(402653184,1,{ionHeader:0}),l.Hb(402653184,2,{ionContent:0}),l.Hb(402653184,3,{hideInput:0}),l.Hb(402653184,4,{ionInfiniteScroll:0}),(t()(),l.qb(4,0,null,null,11,"ion-header",[["mode","ios"]],null,null,null,r.nb,r.q)),l.pb(5,49152,[[1,4],["header",4]],0,s.B,[l.h,l.k,l.x],{mode:[0,"mode"]},null),(t()(),l.qb(6,0,null,0,9,"ion-toolbar",[["mode","ios"]],null,null,null,r.Tb,r.W)),l.pb(7,49152,null,0,s.zb,[l.h,l.k,l.x],{mode:[0,"mode"]},null),(t()(),l.qb(8,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,r.cb,r.f)),l.pb(9,49152,null,0,s.l,[l.h,l.k,l.x],null,null),(t()(),l.qb(10,0,null,0,2,"ion-back-button",[["defaultHref","/home/index"],["text","\u8fd4\u56de"]],null,[[null,"click"]],(function(t,n,e){var o=!0;return"click"===n&&(o=!1!==l.Bb(t,12).onClick(e)&&o),o}),r.Z,r.c)),l.pb(11,49152,null,0,s.g,[l.h,l.k,l.x],{defaultHref:[0,"defaultHref"],text:[1,"text"]},null),l.pb(12,16384,null,0,s.h,[[2,s.fb],s.Fb,s.d],{defaultHref:[0,"defaultHref"]},null),(t()(),l.qb(13,0,null,0,2,"ion-title",[],null,null,null,r.Sb,r.V)),l.pb(14,49152,null,0,s.xb,[l.h,l.k,l.x],null,null),(t()(),l.Jb(-1,0,[" \u6d77\u62a5 "])),(t()(),l.qb(16,0,null,null,18,"ion-content",[],null,[[null,"ionScroll"]],(function(t,n,e){var l=!0;return"ionScroll"===n&&(l=0!=(t.component.scrollToTopFlag=e.detail.currentY>450)&&l),l}),r.ib,r.l)),l.pb(17,49152,[[2,4]],0,s.u,[l.h,l.k,l.x],{scrollEvents:[0,"scrollEvents"]},null),(t()(),l.fb(16777216,null,0,1,null,C)),l.pb(19,16384,null,0,a.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(t()(),l.fb(16777216,null,0,1,null,v)),l.pb(21,278528,null,0,a.i,[l.M,l.J,l.q],{ngForOf:[0,"ngForOf"]},null),(t()(),l.qb(22,0,null,0,8,"ion-fab",[["horizontal","end"],["slot","fixed"],["vertical","bottom"]],null,null,null,r.lb,r.n)),l.Gb(512,null,a.r,a.s,[l.q,l.r,l.k,l.B]),l.pb(24,278528,null,0,a.h,[a.r],{ngClass:[0,"ngClass"]},null),l.Eb(25,{active:0}),l.pb(26,49152,null,0,s.w,[l.h,l.k,l.x],{horizontal:[0,"horizontal"],vertical:[1,"vertical"]},null),(t()(),l.qb(27,0,null,0,3,"ion-fab-button",[["color","medium"]],null,[[null,"click"]],(function(t,n,e){var l=!0;return"click"===n&&(l=!1!==t.component.ionContent.scrollToTop(400)&&l),l}),r.kb,r.o)),l.pb(28,49152,null,0,s.x,[l.h,l.k,l.x],{color:[0,"color"]},null),(t()(),l.qb(29,0,null,0,1,"ion-icon",[["name","arrow-up-outline"]],null,null,null,r.ob,r.r)),l.pb(30,49152,null,0,s.C,[l.h,l.k,l.x],{name:[0,"name"]},null),(t()(),l.qb(31,0,null,0,3,"ion-infinite-scroll",[["threshold","100px"]],null,[[null,"ionInfinite"]],(function(t,n,e){var l=!0;return"ionInfinite"===n&&(l=!1!==t.component.loadMore()&&l),l}),r.rb,r.t)),l.pb(32,49152,[[4,4]],0,s.E,[l.h,l.k,l.x],{threshold:[0,"threshold"]},null),(t()(),l.qb(33,0,null,0,1,"ion-infinite-scroll-content",[["loadingText","\u52a0\u8f7d\u66f4\u591a..."]],null,null,null,r.qb,r.u)),l.pb(34,49152,null,0,s.F,[l.h,l.k,l.x],{loadingText:[0,"loadingText"]},null),(t()(),l.qb(35,0,[[3,0],["hideInput",1]],null,0,"input",[["id","hide-input"],["readonly",""]],null,null,null,null,null))],(function(t,n){var e=n.component;t(n,5,0,"ios"),t(n,7,0,"ios"),t(n,11,0,"/home/index","\u8fd4\u56de"),t(n,12,0,"/home/index"),t(n,17,0,!0),t(n,19,0,e.category.data&&e.category.data.length>0),t(n,21,0,e.data);var l=t(n,25,0,e.scrollToTopFlag);t(n,24,0,l),t(n,26,0,"end","bottom"),t(n,28,0,"medium"),t(n,30,0,"arrow-up-outline"),t(n,32,0,"100px"),t(n,34,0,"\u52a0\u8f7d\u66f4\u591a...")}),null)}function y(t){return l.Lb(0,[(t()(),l.qb(0,0,null,null,2,"app-poster",[],null,null,null,_,x)),l.Gb(512,null,h,h,[u.a,c.c,s.a]),l.pb(2,114688,null,0,f,[h,s.Cb,b.a,s.Nb,g.a],null,null)],(function(t,n){t(n,2,0)}),null)}var M=l.mb("app-poster",f,y,{},{},[]),O=e("pwXF"),k=e("l0Bj"),w=e("ADsi");e.d(n,"PosterModuleNgFactory",(function(){return z}));var z=l.nb(o,[],(function(t){return l.yb([l.zb(512,l.j,l.X,[[8,[i.a,M]],[3,l.j],l.v]),l.zb(4608,a.l,a.k,[l.s,[2,a.w]]),l.zb(4608,O.m,O.m,[]),l.zb(4608,s.b,s.b,[l.x,l.g]),l.zb(4608,s.Eb,s.Eb,[s.b,l.j,l.p]),l.zb(4608,s.Ib,s.Ib,[s.b,l.j,l.p]),l.zb(1073742336,a.b,a.b,[]),l.zb(1073742336,O.l,O.l,[]),l.zb(1073742336,O.b,O.b,[]),l.zb(1073742336,s.Bb,s.Bb,[]),l.zb(1073742336,k.r,k.r,[[2,k.w],[2,k.n]]),l.zb(1073742336,w.a,w.a,[]),l.zb(1073742336,o,o,[]),l.zb(1024,k.l,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);